{"ast":null,"code":"import { r as registerInstance, c as createEvent, h, g as getElement } from './core-85189c77.js';\nimport { i as initBasics, d as destroyBasics } from './commonComponentFeatures-b771e888.js';\nimport { d as debounce } from './helpers-bb43a8d9.js';\nvar NavigationKeys = /*#__PURE__*/(() => {\n  (function (NavigationKeys) {\n    NavigationKeys[\"ArrowUp\"] = \"ArrowUp\";\n    NavigationKeys[\"ArrowDown\"] = \"ArrowDown\";\n    NavigationKeys[\"Enter\"] = \"Enter\";\n    NavigationKeys[\"Escape\"] = \"Escape\";\n  })(NavigationKeys || (NavigationKeys = {}));\n\n  return NavigationKeys;\n})();\nconst InputDataTypeahead = class {\n  constructor(hostRef) {\n    registerInstance(this, hostRef);\n    /**\n     * The design version of the framework\n     */\n\n    this.designVersion = null;\n    /**\n     * The options within the list\n     */\n\n    this.options = [];\n    /**\n     * Typeahead selection value\n     */\n\n    this.value = null;\n    /**\n     * Input label\n     */\n\n    this.label = '';\n    /**\n     * Input value palceholder\n     */\n\n    this.placeholder = 'Enter keywords';\n    /**\n     * When set, then debounce time will be applied after user writes into the input\n     * (in miliseconds)\n     */\n\n    this.debounceTime = 0;\n    /**\n     * Specify whether component should render from right to left\n     */\n\n    this.rtl = false;\n    /**\n     * When set to true the element is disabled\n     */\n\n    this.disabled = false;\n    /**\n     * When set to true cwc-loader is displayed at the end of the field\n     */\n\n    this.loading = false;\n    /**\n     * When set to true the element is required and the label is decorated with an asterisk (*)\n     */\n\n    this.required = false;\n    /**\n     * Status of the form field.\n     */\n\n    this.status = 'regular';\n    /**\n     * Minimum length to trigger suggestions\n     */\n\n    this.minQueryLength = 1;\n    /**\n     * Disables the filtering in UI\n     */\n\n    this.disableSuggestions = false;\n    /**\n     * Specify if input label should render for mobile\n     */\n\n    this.mobile = false;\n    /**\n     * When set to true the component doesn't render form-group wrapper\n     */\n\n    this.unwrap = false;\n    /**\n     * This property sets the appereance variation of the input.\n     */\n\n    this.variant = 'regular';\n    /**\n     * This property sets the label for when there are no results for the entered query.\n     */\n\n    this.noOptionsLabel = 'No options available';\n    /**\n     * The overlay min width;\n     */\n\n    this.overlayMinWidth = '200px';\n    /**\n     * The overlay max width;\n     */\n\n    this.overlayMaxWidth = 'auto';\n    /**\n     * The overlay min height;\n     */\n\n    this.overlayMinHeight = '0px';\n    /**\n     * The overlay max heeight;\n     */\n\n    this.overlayMaxHeight = '220px';\n    /**\n     * The control value\n     */\n\n    this.controlValue = null;\n    /**\n     * Stores the position of the selected option for keyboard navigation\n     */\n\n    this.selectedOptionIndex = -1;\n    /**\n     * Defines if the window with options should be shown\n     */\n\n    this.showSuggestions = false;\n    /**\n     * Navigates the data list with the keyboard\n     * @param key Event\n     */\n\n    this.navigateWithKeyboard = e => {\n      e.preventDefault();\n      const key = e.key;\n      const keyboardNavigationMap = new Map([[NavigationKeys.ArrowUp, () => this.navigateWithArrowsKeys(NavigationKeys.ArrowUp)], [NavigationKeys.ArrowDown, () => this.navigateWithArrowsKeys(NavigationKeys.ArrowDown)], [NavigationKeys.Enter, () => this.selectOptionByEnter()], [NavigationKeys.Escape, () => this.showSuggestions = false]]);\n      const keyFn = keyboardNavigationMap.get(key);\n      keyFn && keyFn();\n    };\n\n    this.selectOptionByEnter = () => {\n      if (this.selectedOptionIndex >= 0) {\n        this.selectOption(this.options[this.selectedOptionIndex]);\n      }\n    };\n\n    this.onChange = ev => {\n      ev.stopPropagation();\n\n      if (ev.detail === null) {\n        return;\n      }\n\n      this.controlValue = ev.detail;\n      this.cwcQueryChange.emit(this.controlValue);\n    };\n\n    this.onInput = ev => {\n      ev.preventDefault();\n      ev.stopPropagation();\n      const target = ev.target;\n      const filterString = target.value;\n      const fsLength = filterString.length;\n\n      if (fsLength >= this.minQueryLength) {\n        this.showSuggestions = true;\n        this.controlValue = filterString;\n      } else {\n        this.showSuggestions = false;\n        this.controlValue = null;\n      }\n    };\n\n    this.onBlur = ev => {\n      ev.stopPropagation();\n      this.cwcBlur.emit();\n    };\n\n    this.onFocus = ev => {\n      ev.stopPropagation();\n      this.cwcFocus.emit();\n    };\n\n    this.resizeOverlayWithDebounce = debounce(function () {\n      const inputDims = this.inputEl.getBoundingClientRect();\n      this.dropdownEl.style.width = `${inputDims.width}px`;\n    }.bind(this));\n\n    this.highlightOption = e => {\n      const optionElement = e.target;\n      const optionIndex = Array.from(this.dropdownEl.children).indexOf(optionElement);\n      let hlRemoved = false;\n      let hlAdded = false;\n\n      for (let i = 0; i < this.options.length; i++) {\n        const option = this.options[i];\n\n        if (option.highlighted) {\n          option.highlighted = false;\n          this.dropdownEl.children[i].classList.remove('highlighted');\n          hlRemoved = true;\n        }\n\n        if (i === optionIndex) {\n          option.highlighted = true;\n          hlAdded = true;\n        }\n\n        if (hlRemoved && hlAdded) {\n          break;\n        }\n      }\n\n      optionElement.classList.add('focused');\n    };\n\n    this.unHighlightOption = e => {\n      const optionElement = e.target;\n      optionElement.classList.remove('focused');\n    };\n\n    this.cwcInput = createEvent(this, \"cwcInput\", 7);\n    this.cwcQueryChange = createEvent(this, \"cwcQueryChange\", 7);\n    this.cwcOptionHighlighted = createEvent(this, \"cwcOptionHighlighted\", 7);\n    this.cwcSelect = createEvent(this, \"cwcSelect\", 7);\n    this.cwcBlur = createEvent(this, \"cwcBlur\", 7);\n    this.cwcFocus = createEvent(this, \"cwcFocus\", 7);\n  }\n\n  setValue(newValue) {\n    for (let i = 0; i < this.options.length; i++) {\n      if (this.options[i].value === newValue.value) {\n        this.selectedOptionIndex = i;\n        this.controlValue = newValue.label;\n        break;\n      }\n    }\n  }\n\n  onControlValueChange(newValue, oldValue) {\n    if (newValue !== oldValue) {\n      this.filterOptions();\n    }\n  }\n\n  navigateWithArrowsKeys(key) {\n    const down = key === NavigationKeys.ArrowDown ? true : false;\n    let nextOption = null;\n    let nextIndex = null;\n    const sum = down ? 1 : -1;\n    let move = true;\n    let nextOptionIndex = this.selectedOptionIndex;\n    const restartIndex = down ? 0 : this.options.length - 1;\n\n    const rangeCheck = (down, index) => {\n      return down ? index < this.options.length : index >= 0;\n    };\n\n    while (move) {\n      nextOptionIndex = nextOptionIndex + sum;\n\n      if (rangeCheck(down, nextOptionIndex)) {\n        if (!this.options[nextOptionIndex].hidden) {\n          nextOption = this.options[nextOptionIndex];\n          nextIndex = nextOptionIndex;\n          move = false;\n        }\n      } else {\n        nextOptionIndex = restartIndex - sum;\n      }\n    }\n\n    if (nextOption) {\n      this.selectedOptionIndex > -1 && this.dropdownEl.children[this.selectedOptionIndex].classList.remove('focused');\n      this.selectedOptionIndex = nextIndex;\n      const nextOptionEl = this.dropdownEl.children[this.selectedOptionIndex];\n      nextOptionEl.classList.add('focused');\n      nextOptionEl.scrollIntoView({\n        behavior: 'smooth',\n        block: 'nearest',\n        inline: 'start'\n      });\n      this.cwcOptionHighlighted.emit(nextOption);\n    }\n  }\n\n  selectOption(option) {\n    if (option) {\n      this.controlValue = option.label;\n      this.cwcQueryChange.emit(this.controlValue);\n      this.cwcSelect.emit(option);\n    }\n\n    this.showSuggestions = false;\n  }\n\n  filterOptions() {\n    const nuOptions = [...this.options]; // const isEmpty = false;\n\n    let hiddenOptions = 0;\n    nuOptions.forEach(option => {\n      let match = false;\n\n      if (this.controlValue && this.controlValue !== '') {\n        match = (option.value + option.label).toLowerCase().includes(this.controlValue.toLowerCase());\n      }\n\n      option.hidden = !match;\n      !match && hiddenOptions++;\n    });\n    this.allOptionsHidden = hiddenOptions === nuOptions.length;\n    this.options = nuOptions;\n  }\n\n  componentWillLoad() {\n    initBasics(this);\n  }\n\n  disconnectedCallback() {\n    destroyBasics(this);\n    window.removeEventListener('resize', this.resizeOverlayWithDebounce);\n  }\n\n  componentDidLoad() {\n    if (this.value) {\n      this.controlValue = this.value.label;\n    }\n\n    const inputDims = this.inputEl.getBoundingClientRect();\n    this.dropdownEl.style.width = `${inputDims.width}px`;\n    window.addEventListener('resize', this.resizeOverlayWithDebounce.bind(this));\n  }\n\n  render() {\n    return h(\"div\", {\n      class: `cwc-input-data-typeahead ${this.designVersion}`\n    }, h(\"cwc-input\", {\n      ref: el => this.inputEl = el,\n      placeholder: this.placeholder,\n      value: this.controlValue,\n      disabled: this.disabled,\n      required: this.required,\n      status: this.status,\n      statusMessage: this.statusMessage,\n      label: this.label,\n      \"debounce-time\": this.debounceTime,\n      maxlength: this.maxQuerylength,\n      loading: this.loading,\n      onCwcChange: this.onChange,\n      onCwcInput: this.onInput,\n      onCwcFocus: this.onFocus,\n      onCwcBlur: this.onBlur,\n      onKeyUp: this.navigateWithKeyboard,\n      style: {\n        width: '100%'\n      },\n      mobile: this.mobile,\n      designVersion: this.designVersion,\n      unwrap: this.unwrap,\n      variant: this.variant\n    }), h(\"div\", {\n      ref: el => this.dropdownEl = el,\n      class: 'cwc-input-data-typeahead__options' + (this.showSuggestions ? ' animation' : ' hidden') + (this.unwrap ? ' cwc-input-data-typeahead__options--unwrap' : '') + (this.allOptionsHidden ? ' cwc-input-data-typeahead__options--empty' : ''),\n      role: \"listbox\",\n      \"aria-expanded\": this.showSuggestions,\n      \"aria-readonly\": true,\n      \"aria-disabled\": this.disableSuggestions,\n      \"data-no-options-label\": this.noOptionsLabel,\n      style: {\n        minWidth: this.overlayMinWidth,\n        maxWidth: this.overlayMaxWidth,\n        minHeight: this.overlayMinHeight,\n        maxHeight: this.showSuggestions ? this.overlayMaxHeight : '0px'\n      }\n    }, this.options.map(option => {\n      return h(\"div\", {\n        class: `suggestion ${option.selected ? 'selected' : ''} ${option.hidden ? 'hidden' : ''}`,\n        onMouseEnter: this.highlightOption,\n        onMouseLeave: this.unHighlightOption,\n        onClick: () => {\n          this.selectOption(option);\n        },\n        \"attr-data-value\": option.value\n      }, option.label);\n    })));\n  }\n\n  get host() {\n    return getElement(this);\n  }\n\n  static get watchers() {\n    return {\n      \"value\": [\"setValue\"],\n      \"controlValue\": [\"onControlValueChange\"]\n    };\n  }\n\n  static get style() {\n    return \"*{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}:host{display:inline-block}.cwc-input-data-typeahead{font-family:inherit}.cwc-input-data-typeahead__options{background:var(--cwc-color-grayscale-white,#fff);border-radius:3px;-webkit-box-shadow:0 8px 13px rgba(0,0,0,.3);box-shadow:0 8px 13px rgba(0,0,0,.3);display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;position:absolute;width:100%;-webkit-box-sizing:border-box;box-sizing:border-box;z-index:3001;margin-top:-1.25rem;padding:0 0;overflow-x:hidden;overflow-y:auto;-webkit-transition:max-height .5s,padding .5s;transition:max-height .5s,padding .5s;background-repeat:no-repeat;border-top:2px solid var(--cwc-color-status-info,#3fa9f5);background-size:100% 3px;background-position:0 0}.cwc-input-data-typeahead__options.animation{-webkit-animation:activate .35s linear 1;animation:activate .35s linear 1}.cwc-input-data-typeahead__options--empty:before{content:attr(data-no-options-label);display:block;padding:.5rem 1rem;color:#636c72}.cwc-input-data-typeahead__options.hidden{max-height:0;padding:0;border:none;-webkit-animation:deactivate .35s linear 1;animation:deactivate .35s linear 1;-webkit-animation-fill-mode:forwards;animation-fill-mode:forwards;background-position:100% 0}.cwc-input-data-typeahead__options__wrapper{direction:ltr!important;height:5.4em;display:-ms-flexbox;display:flex;-ms-flex-pack:center;justify-content:center;width:100%;max-width:150px;margin:auto}.cwc-input-data-typeahead__options--unwrap{margin-top:0}.cwc-input-data-typeahead__warning-message{text-align:center;padding:1.5rem 1rem}.cwc-input-data-typeahead__warning-message p{font-size:.75rem;color:var(--cwc-color-grayscale-dark,#333);margin:.5rem 0 0}.suggestion{display:block;padding:.5rem 1rem;font-size:1rem;cursor:pointer;white-space:nowrap;text-overflow:ellipsis;overflow:hidden;line-height:1rem;min-height:1rem}.suggestion.focused{background-color:var(--cwc-color-elements-table-row-active,#cce4f8)}.suggestion.hidden{display:none}::-webkit-scrollbar{width:12px}::-webkit-scrollbar-track{background:transparent}::-webkit-scrollbar-thumb{background-image:url(\\\"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iOCIgaGVpZ2h0PSI0IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxwYXRoIGQ9Ik0wIDRhNCA0IDAgMSAxIDggMEgweiIgZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBmaWxsLW9wYWNpdHk9Ii40Ii8+PC9zdmc+\\\"),url(\\\"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iOCIgaGVpZ2h0PSI0IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxwYXRoIGQ9Ik0wIDBhNCA0IDAgMSAwIDggMEgweiIgZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBmaWxsLW9wYWNpdHk9Ii40Ii8+PC9zdmc+\\\"),url(\\\"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iOCIgaGVpZ2h0PSI4IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxwYXRoIGZpbGw9IiMwMDAiIGQ9Ik0wIDBoOHY4SDB6IiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGZpbGwtb3BhY2l0eT0iLjQiLz48L3N2Zz4=\\\");background-repeat:no-repeat,no-repeat,no-repeat;background-position:top,bottom,50%;background-size:auto,auto,8px calc(100% - 8px)}::-webkit-scrollbar-thumb:hover{background-image:url(\\\"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iOCIgaGVpZ2h0PSI0IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxwYXRoIGQ9Ik0wIDRhNCA0IDAgMSAxIDggMEgweiIgZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBmaWxsLW9wYWNpdHk9Ii42Ii8+PC9zdmc+\\\"),url(\\\"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iOCIgaGVpZ2h0PSI0IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxwYXRoIGQ9Ik0wIDBhNCA0IDAgMSAwIDggMEgweiIgZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBmaWxsLW9wYWNpdHk9Ii42Ii8+PC9zdmc+\\\"),url(\\\"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iOCIgaGVpZ2h0PSI4IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxwYXRoIGZpbGw9IiMwMDAiIGQ9Ik0wIDBoOHY4SDB6IiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGZpbGwtb3BhY2l0eT0iLjYiLz48L3N2Zz4=\\\")}.cwc-input-data-typeahead[dir=rtl]{font-family:inherit}\\@-webkit-keyframes activate{0%{background-size:0 3px}to{background-size:100% 3px}}\\@keyframes activate{0%{background-size:0 3px}to{background-size:100% 3px}}\\@-webkit-keyframes deactivate{0%{background-size:100% 3px}to{background-size:0 3px}}\\@keyframes deactivate{0%{background-size:100% 3px}to{background-size:0 3px}}\";\n  }\n\n};\nexport { InputDataTypeahead as cwc_input_data_typeahead };","map":null,"metadata":{},"sourceType":"module"}