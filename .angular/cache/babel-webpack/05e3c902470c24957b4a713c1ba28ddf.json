{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/pingu/Documents/Tec/Carrera Tec sem 6/parcial_2/Cemex_Materiales/Cemex_Login_V1.0/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { r as registerInstance, c as createEvent, h, H as Host, g as getElement } from './core-85189c77.js';\nimport { i as initBasics, d as destroyBasics } from './commonComponentFeatures-b771e888.js';\nimport { c as createCommonjsModule, u as unwrapExports } from './_commonjsHelpers-97e6d7b1.js';\nvar Key_enum = createCommonjsModule(function (module, exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  var Key;\n\n  (function (Key) {\n    Key[Key[\"Backspace\"] = 8] = \"Backspace\";\n    Key[Key[\"Tab\"] = 9] = \"Tab\";\n    Key[Key[\"Enter\"] = 13] = \"Enter\";\n    Key[Key[\"Shift\"] = 16] = \"Shift\";\n    Key[Key[\"Ctrl\"] = 17] = \"Ctrl\";\n    Key[Key[\"Alt\"] = 18] = \"Alt\";\n    Key[Key[\"PauseBreak\"] = 19] = \"PauseBreak\";\n    Key[Key[\"CapsLock\"] = 20] = \"CapsLock\";\n    Key[Key[\"Escape\"] = 27] = \"Escape\";\n    Key[Key[\"Space\"] = 32] = \"Space\";\n    Key[Key[\"PageUp\"] = 33] = \"PageUp\";\n    Key[Key[\"PageDown\"] = 34] = \"PageDown\";\n    Key[Key[\"End\"] = 35] = \"End\";\n    Key[Key[\"Home\"] = 36] = \"Home\";\n    Key[Key[\"LeftArrow\"] = 37] = \"LeftArrow\";\n    Key[Key[\"UpArrow\"] = 38] = \"UpArrow\";\n    Key[Key[\"RightArrow\"] = 39] = \"RightArrow\";\n    Key[Key[\"DownArrow\"] = 40] = \"DownArrow\";\n    Key[Key[\"Insert\"] = 45] = \"Insert\";\n    Key[Key[\"Delete\"] = 46] = \"Delete\";\n    Key[Key[\"Zero\"] = 48] = \"Zero\";\n    Key[Key[\"ClosedParen\"] = 48] = \"ClosedParen\";\n    Key[Key[\"One\"] = 49] = \"One\";\n    Key[Key[\"ExclamationMark\"] = 49] = \"ExclamationMark\";\n    Key[Key[\"Two\"] = 50] = \"Two\";\n    Key[Key[\"AtSign\"] = 50] = \"AtSign\";\n    Key[Key[\"Three\"] = 51] = \"Three\";\n    Key[Key[\"PoundSign\"] = 51] = \"PoundSign\";\n    Key[Key[\"Hash\"] = 51] = \"Hash\";\n    Key[Key[\"Four\"] = 52] = \"Four\";\n    Key[Key[\"DollarSign\"] = 52] = \"DollarSign\";\n    Key[Key[\"Five\"] = 53] = \"Five\";\n    Key[Key[\"PercentSign\"] = 53] = \"PercentSign\";\n    Key[Key[\"Six\"] = 54] = \"Six\";\n    Key[Key[\"Caret\"] = 54] = \"Caret\";\n    Key[Key[\"Hat\"] = 54] = \"Hat\";\n    Key[Key[\"Seven\"] = 55] = \"Seven\";\n    Key[Key[\"Ampersand\"] = 55] = \"Ampersand\";\n    Key[Key[\"Eight\"] = 56] = \"Eight\";\n    Key[Key[\"Star\"] = 56] = \"Star\";\n    Key[Key[\"Asterik\"] = 56] = \"Asterik\";\n    Key[Key[\"Nine\"] = 57] = \"Nine\";\n    Key[Key[\"OpenParen\"] = 57] = \"OpenParen\";\n    Key[Key[\"A\"] = 65] = \"A\";\n    Key[Key[\"B\"] = 66] = \"B\";\n    Key[Key[\"C\"] = 67] = \"C\";\n    Key[Key[\"D\"] = 68] = \"D\";\n    Key[Key[\"E\"] = 69] = \"E\";\n    Key[Key[\"F\"] = 70] = \"F\";\n    Key[Key[\"G\"] = 71] = \"G\";\n    Key[Key[\"H\"] = 72] = \"H\";\n    Key[Key[\"I\"] = 73] = \"I\";\n    Key[Key[\"J\"] = 74] = \"J\";\n    Key[Key[\"K\"] = 75] = \"K\";\n    Key[Key[\"L\"] = 76] = \"L\";\n    Key[Key[\"M\"] = 77] = \"M\";\n    Key[Key[\"N\"] = 78] = \"N\";\n    Key[Key[\"O\"] = 79] = \"O\";\n    Key[Key[\"P\"] = 80] = \"P\";\n    Key[Key[\"Q\"] = 81] = \"Q\";\n    Key[Key[\"R\"] = 82] = \"R\";\n    Key[Key[\"S\"] = 83] = \"S\";\n    Key[Key[\"T\"] = 84] = \"T\";\n    Key[Key[\"U\"] = 85] = \"U\";\n    Key[Key[\"V\"] = 86] = \"V\";\n    Key[Key[\"W\"] = 87] = \"W\";\n    Key[Key[\"X\"] = 88] = \"X\";\n    Key[Key[\"Y\"] = 89] = \"Y\";\n    Key[Key[\"Z\"] = 90] = \"Z\";\n    Key[Key[\"LeftWindowKey\"] = 91] = \"LeftWindowKey\";\n    Key[Key[\"RightWindowKey\"] = 92] = \"RightWindowKey\";\n    Key[Key[\"SelectKey\"] = 93] = \"SelectKey\";\n    Key[Key[\"Numpad0\"] = 96] = \"Numpad0\";\n    Key[Key[\"Numpad1\"] = 97] = \"Numpad1\";\n    Key[Key[\"Numpad2\"] = 98] = \"Numpad2\";\n    Key[Key[\"Numpad3\"] = 99] = \"Numpad3\";\n    Key[Key[\"Numpad4\"] = 100] = \"Numpad4\";\n    Key[Key[\"Numpad5\"] = 101] = \"Numpad5\";\n    Key[Key[\"Numpad6\"] = 102] = \"Numpad6\";\n    Key[Key[\"Numpad7\"] = 103] = \"Numpad7\";\n    Key[Key[\"Numpad8\"] = 104] = \"Numpad8\";\n    Key[Key[\"Numpad9\"] = 105] = \"Numpad9\";\n    Key[Key[\"Multiply\"] = 106] = \"Multiply\";\n    Key[Key[\"Add\"] = 107] = \"Add\";\n    Key[Key[\"Subtract\"] = 109] = \"Subtract\";\n    Key[Key[\"DecimalPoint\"] = 110] = \"DecimalPoint\";\n    Key[Key[\"Divide\"] = 111] = \"Divide\";\n    Key[Key[\"F1\"] = 112] = \"F1\";\n    Key[Key[\"F2\"] = 113] = \"F2\";\n    Key[Key[\"F3\"] = 114] = \"F3\";\n    Key[Key[\"F4\"] = 115] = \"F4\";\n    Key[Key[\"F5\"] = 116] = \"F5\";\n    Key[Key[\"F6\"] = 117] = \"F6\";\n    Key[Key[\"F7\"] = 118] = \"F7\";\n    Key[Key[\"F8\"] = 119] = \"F8\";\n    Key[Key[\"F9\"] = 120] = \"F9\";\n    Key[Key[\"F10\"] = 121] = \"F10\";\n    Key[Key[\"F11\"] = 122] = \"F11\";\n    Key[Key[\"F12\"] = 123] = \"F12\";\n    Key[Key[\"NumLock\"] = 144] = \"NumLock\";\n    Key[Key[\"ScrollLock\"] = 145] = \"ScrollLock\";\n    Key[Key[\"SemiColon\"] = 186] = \"SemiColon\";\n    Key[Key[\"Equals\"] = 187] = \"Equals\";\n    Key[Key[\"Comma\"] = 188] = \"Comma\";\n    Key[Key[\"Dash\"] = 189] = \"Dash\";\n    Key[Key[\"Period\"] = 190] = \"Period\";\n    Key[Key[\"UnderScore\"] = 189] = \"UnderScore\";\n    Key[Key[\"PlusSign\"] = 187] = \"PlusSign\";\n    Key[Key[\"ForwardSlash\"] = 191] = \"ForwardSlash\";\n    Key[Key[\"Tilde\"] = 192] = \"Tilde\";\n    Key[Key[\"GraveAccent\"] = 192] = \"GraveAccent\";\n    Key[Key[\"OpenBracket\"] = 219] = \"OpenBracket\";\n    Key[Key[\"ClosedBracket\"] = 221] = \"ClosedBracket\";\n    Key[Key[\"Quote\"] = 222] = \"Quote\";\n  })(Key = exports.Key || (exports.Key = {}));\n});\nunwrapExports(Key_enum);\nvar Key_enum_1 = Key_enum.Key;\nconst Login = class {\n  constructor(hostRef) {\n    var _this = this;\n\n    registerInstance(this, hostRef);\n    this.loginParams = {};\n    /**\n     * state variable that holds the user name\n     */\n\n    this.username = null;\n    /**\n     * state variable that holds the password\n     */\n\n    this.password = null;\n    /**\n     * If submit is possible\n     */\n\n    this.submitDisabled = true;\n    /**\n     * If login error appeared\n     */\n\n    this.loginError = false;\n    /**\n     * If server error appeared\n     */\n\n    this.serverError = false;\n    /**\n     * The design version of the framework\n     */\n\n    this.designVersion = null;\n    /**\n     * Specify the login error label\n     */\n\n    this.labelLoginError = `The user or password you entered are incorrect. Please try again.`;\n    /**\n     * Specify the server error label\n     */\n\n    this.labelServerError = `The service is not available at the moment. Please try again later.`;\n    /**\n     * Specify the username input label\n     */\n\n    this.labelUsername = `Username`;\n    /**\n     * Specify the type of data to accept on username input\n     */\n\n    this.inputUsernameType = 'text';\n    /**\n     * Specify the username input placeholder label\n     */\n\n    this.labelUsernamePlaceholder = `Enter your Username`;\n    /**\n     * Specify the password input label\n     */\n\n    this.labelPassword = `Password`;\n    /**\n     * Specify the password input label\n     */\n\n    this.labelPasswordPlaceholder = `Enter your Password`;\n    /**\n     * Specify the login CTA label\n     */\n\n    this.labelLoginCTA = `Log In`;\n    /**\n     * Specify the oauth login endpoint\n     */\n\n    this.oauthEndpoint = 'https://dev2.cemexgo.com/api/v2/secm/oam/oauth2/token';\n    /**\n     * Specify if the component shows in RTL language\n     */\n\n    this.rtl = false;\n    /**\n     * Specify if the component call to action button width\n     */\n\n    this.logInButtonWidth = `auto`;\n    /**\n     * Specify if input label should render for mobile\n     */\n\n    this.mobile = false;\n    this.validateData = /*#__PURE__*/_asyncToGenerator(function* () {\n      _this.submitDisabled = _this.username && _this.password ? false : true;\n      return _this.submitDisabled;\n    });\n\n    this.trackKeystrokes = /*#__PURE__*/function () {\n      var _ref2 = _asyncToGenerator(function* (e) {\n        // let's listen to the key events so that we can track the enter for submission\n        if (e.target === _this.host || _this.host.contains(e.target)) {\n          // let's validate that there's some input\n          yield _this.validateData();\n\n          if (e.keyCode === Key_enum_1.Enter && !_this.submitDisabled) {\n            // we are submitting\n            // and we login\n            _this.logIn();\n          }\n        }\n      });\n\n      return function (_x) {\n        return _ref2.apply(this, arguments);\n      };\n    }();\n\n    this.logIn = /*#__PURE__*/_asyncToGenerator(function* () {\n      const loginObject = Object.assign(Object.assign({}, _this.loginParams.body), {\n        username: _this.username,\n        password: _this.password\n      });\n      const searchParams = Object.keys(loginObject).map(key => {\n        return encodeURIComponent(key) + '=' + encodeURIComponent(loginObject[key]);\n      }).join('&');\n\n      try {\n        const creds = yield fetch(_this.oauthEndpoint, {\n          method: 'POST',\n          mode: 'cors',\n          cache: 'no-cache',\n          headers: _this.loginParams.header,\n          body: searchParams\n        });\n\n        if (creds.status) {\n          if (creds.status === 200) {\n            _this.loginError = false;\n            _this.serverError = false;\n          }\n\n          if (Math.floor(creds.status / 100) === 4) {\n            _this.loginError = true;\n            _this.serverError = false;\n          }\n\n          if (Math.floor(creds.status / 100) === 5) {\n            _this.serverError = true;\n          }\n        }\n\n        _this.loginEvent.emit(creds);\n      } catch (err) {\n        _this.loginEvent.emit(err);\n      }\n    });\n\n    this.usernameChange = e => {\n      if (e.detail) {\n        this.username = e.target.value;\n      }\n    };\n\n    this.passwordChange = e => {\n      this.password = e.target.value.trim();\n    };\n\n    this.componentDidLoad = /*#__PURE__*/_asyncToGenerator(function* () {\n      // get the params from the params tags\n      const paramTags = _this.host.querySelectorAll('cwc-login-param');\n\n      paramTags.forEach(paramTag => {\n        const paramType = paramTag.getAttribute('type');\n        const paramKey = paramTag.getAttribute('name');\n        const paramValue = paramTag.getAttribute('value');\n\n        if (!_this.loginParams[paramType]) {\n          _this.loginParams[paramType] = {};\n        }\n\n        _this.loginParams[paramType][paramKey] = paramValue;\n      });\n    });\n\n    this.addKeystrokeTracking = () => {\n      window.addEventListener('keyup', this.trackKeystrokes);\n    };\n\n    this.removeKeystrokeTracking = () => {\n      window.removeEventListener('keyup', this.trackKeystrokes);\n    };\n\n    this.loginEvent = createEvent(this, \"cwcLogin\", 7);\n  }\n\n  validateUsername(newValue, oldValue) {\n    if (newValue !== oldValue) {\n      this.validateData();\n    }\n  }\n\n  validatePassword(newValue, oldValue) {\n    if (newValue !== oldValue) {\n      this.validateData();\n    }\n  }\n\n  componentWillLoad() {\n    initBasics(this);\n  }\n\n  disconnectedCallback() {\n    window.removeEventListener('keyup', this.trackKeystrokes);\n    destroyBasics(this);\n  }\n\n  render() {\n    return h(Host, {\n      class: this.designVersion\n    }, this.loginError ? h(\"div\", {\n      class: \"cwc-login__error\"\n    }, this.labelLoginError) : null, this.serverError ? h(\"div\", {\n      class: \"cwc-login__error\"\n    }, this.labelServerError) : null, h(\"div\", null, h(\"cwc-ld-input\", {\n      name: \"username\",\n      class: \"cwc-login__input\",\n      label: this.labelUsername,\n      placeholder: this.labelUsernamePlaceholder,\n      type: this.inputUsernameType,\n      value: this.username,\n      onCwcFocus: this.addKeystrokeTracking,\n      onCwcBlur: this.removeKeystrokeTracking,\n      onCwcChange: this.usernameChange,\n      onCwcInput: this.usernameChange,\n      mobile: this.mobile,\n      designVersion: this.designVersion\n    })), h(\"div\", null, h(\"cwc-ld-input\", {\n      name: \"password\",\n      class: \"cwc-login__input\",\n      label: this.labelPassword,\n      placeholder: this.labelPasswordPlaceholder,\n      type: \"password\",\n      allowPasswordShow: true,\n      value: this.password,\n      clearOnEdit: false,\n      onCwcFocus: this.addKeystrokeTracking,\n      onCwcBlur: this.removeKeystrokeTracking,\n      onCwcChange: this.passwordChange,\n      onCwcInput: this.passwordChange,\n      mobile: this.mobile,\n      designVersion: this.designVersion\n    })), h(\"slot\", {\n      name: \"ctas\"\n    }), h(\"div\", {\n      class: \"cwc-login__button-wrap\"\n    }, h(\"cwc-button\", {\n      style: {\n        width: this.logInButtonWidth\n      },\n      variant: \"primary-block\",\n      onCwcClick: this.logIn,\n      disabled: this.submitDisabled,\n      designVersion: this.designVersion\n    }, this.labelLoginCTA)));\n  }\n\n  get host() {\n    return getElement(this);\n  }\n\n  static get watchers() {\n    return {\n      \"username\": [\"validateUsername\"],\n      \"password\": [\"validatePassword\"]\n    };\n  }\n\n  static get style() {\n    return \"*{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}cwc-login{display:block;line-height:16px!important}.cwc-login__input{width:100%}.cwc-login__error{color:var(--cwc-login-error-color,var(--cwc-color-status-error,#ee3d42));font-size:.75rem;margin-bottom:.75rem}[dir=ltr] .cwc-login__button-wrap{text-align:right}[dir=rtl] .cwc-login__button-wrap{text-align:left}.cwc-login__button-wrap{margin-top:1rem;text-align:end}\";\n  }\n\n};\nexport { Login as cwc_login };","map":null,"metadata":{},"sourceType":"module"}